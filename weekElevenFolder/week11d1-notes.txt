1ï¸âƒ£ What You Need To Understand
In plain languageâ€¦
User behavior â†’ Kafka â†’ Processing â†’ Features â†’ Model â†’ CAPTCHA
You are simulating website users
â†“
Events are streaming through Kafka (like a conveyor belt)
â†“
A real-time processing engine (Flink + Spark)
extracts patterns
â†“

Those patterns are stored
â¡ Redis = fast lookup for real-time scoring
â¡ PostgreSQL = historical training & analysis
â†“

A FastAPI service loads those features
and predicts whether the user is a BOT

â†“

If risky â†’ send CAPTCHA

Think of it like this analogy:

Doorbell camera:

ğŸ“· Camera â†’ sends events in real time â†’ Kafka
ğŸ§  Something tracks:

movement patterns

timing

behavior
â†’ Flink / Spark

ğŸ—„ Redis â†’ stores â€œwhatâ€™s happening right nowâ€
ğŸ“š Postgres â†’ stores â€œwhat has happened historicallyâ€

ğŸ¤– Model â†’ â€œThis looks suspiciousâ€
ğŸš§ Show challenge

Thatâ€™s all.


ğŸŸ£ Kafka
message broker
used for streaming events
not a database
consumers read from it in real time
Kafka is not where features live â€” itâ€™s where live events pass through.

ğŸ”µ Flink
computes behavioral features
aggregates events into sessions
stateful stream processing
exactly-once guarantees
This is known as stateful processing, meaning Flink remembers past events for a user.
â€œFlink tracks user actions over time, computes session-level behavior, and guarantees correctness using checkpointing.â€

ğŸŸ¢ Spark
computes historical aggregates like IP repuataion
micro-batch Model

Flink is better for ongoing live behavior of ONE user.
Spark is better for history across MANY users.

ğŸ”´ Redis
serves as an online feature store
fast reads(~1-5ms)
used at inference time
Redis stores final feature values, not raw events.

ğŸŸ  PostgreSQL
long-term historical features
used for model retraining
Why store history?
Because models are trained on past labeled data.
Redis is short-term memory
Postgres is long-term storage

ğŸŸ¡ FastAPI Model Service
fetches features
loads model
returns json


â€œKafka streams live events, Flink extracts session-level features in real time, Spark computes historical reputation metrics, Redis stores features for fast inference, PostgreSQL stores them for retraining, and FastAPI serves the bot prediction.â€